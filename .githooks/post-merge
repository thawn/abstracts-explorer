#!/bin/bash
# Post-merge hook to run npm install:vendor when HTML/JS files change

# Get the merge base
MERGE_BASE=$(git merge-base HEAD@{1} HEAD)

# Check if HTML or JS files changed
CHANGED_FILES=$(git diff --name-only $MERGE_BASE HEAD -- \
    'src/abstracts_explorer/web_ui/templates/*.html' \
    'src/abstracts_explorer/web_ui/static/*.js' \
    'src/abstracts_explorer/web_ui/static/*.css' \
    'tailwind.config.js' \
    2>/dev/null)

if [ -n "$CHANGED_FILES" ]; then
    echo "Detected changes in web UI files:"
    echo "$CHANGED_FILES"
    echo "Running npm run install:vendor..."
    npm run install:vendor
fi
